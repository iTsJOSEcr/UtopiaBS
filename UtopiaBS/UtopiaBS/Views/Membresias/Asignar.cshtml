@model UtopiaBS.ViewModels.AsignarMembresiaViewModel

@{
    ViewBag.Title = "Asignar Membresía";
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />

<div class="container py-4">

    <h2 class="text-center fw-bold mb-4" style="color:#1B263B;">
        <i class="bi bi-stars me-2"></i> Asignar Membresía a Cliente
    </h2>

    <!-- ✅ MENSAJES -->
    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success text-center fw-semibold">
            @TempData["Success"]
        </div>
    }

    @if (TempData["Error"] != null)
    {
        <div class="alert alert-danger text-center fw-semibold">
            @TempData["Error"]
        </div>
    }

    <div class="row justify-content-center">
        <div class="col-lg-6">

            <div class="card border-0 shadow-lg rounded-4">
                <div class="card-body p-4">

                    @using (Html.BeginForm("Asignar", "Membresias", FormMethod.Post))
                    {
                        @Html.AntiForgeryToken()

                        <!-- ✅ CLIENTE -->
                        <div class="mb-3">
                            <label class="form-label fw-semibold">Cliente</label>

                            <select name="IdCliente" id="IdCliente" class="form-select" required>
                                <option value="">Seleccione un cliente</option>
                                @foreach (var c in ViewBag.Clientes)
                                {
                                    <option value="@c.IdCliente" @(Model.IdCliente == c.IdCliente ? "selected" : "")>
                                        @c.Nombre - @c.Cedula
                                    </option>
                                }
                            </select>

                            @Html.ValidationMessageFor(m => m.IdCliente, "", new { @class = "text-danger" })
                        </div>

                        <!-- ✅ TIPO MEMBRESÍA -->
                        <div class="mb-3">
                            <label class="form-label fw-semibold">Tipo de Membresía</label>

                            @Html.DropDownListFor(m => m.IdTipoMembresia,
                                (IEnumerable<SelectListItem>)ViewBag.TiposMembresia,
                                "Seleccione una opción",
                                new { @class = "form-select", required = "required" })

                            @Html.ValidationMessageFor(m => m.IdTipoMembresia, "", new { @class = "text-danger" })
                        </div>

                        <!-- ✅ FECHA INICIO (✅ CORREGIDO: SIN asp-for) -->
                        <div class="mb-3">
                            <label class="form-label fw-semibold">Fecha de Inicio</label>

                            @Html.TextBoxFor(m => m.FechaInicio,
                                "{0:yyyy-MM-dd}",
                                new { @class = "form-control", type = "date", required = "required" })

                            @Html.ValidationMessageFor(m => m.FechaInicio, "", new { @class = "text-danger" })
                        </div>

                        <!-- ✅ BOTÓN -->
                        <div class="d-grid mt-4">
                            <button type="submit"
                                    class="btn fw-bold text-dark border-0"
                                    style="background-color:#FFD60A;">
                                <i class="bi bi-check-circle me-2"></i> Asignar Membresía
                            </button>
                        </div>
                    }
                </div>
            </div>

            <!-- ✅ VOLVER -->
            <div class="text-center mt-3">
                <a href="@Url.Action("Panel","Membresias")"
                   class="btn btn-outline-secondary">
                    ← Volver al panel
                </a>
            </div>

        </div>
    </div>
</div>

<style>
    body {
        background-color: #f3f4f6;
    }

    .form-label {
        color: #1B263B;
    }

    .btn:hover {
        opacity: 0.9;
    }
</style>
