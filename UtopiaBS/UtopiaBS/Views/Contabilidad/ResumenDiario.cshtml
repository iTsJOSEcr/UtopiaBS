@model dynamic
@using System.Globalization

@{
    ViewBag.Title = "Resumen Diario";
    var cr = new CultureInfo("es-CR");
}

<div class="container py-5">
    <div class="card shadow-lg border-0 rounded-4 overflow-hidden">
        <!-- ENCABEZADO -->
        <div class="card-header text-white d-flex align-items-center" style="background-color:#1B263B;">
            <h3 class="mb-0 fw-bold"><i class="bi bi-calendar-week me-2"></i> Resumen Diario</h3>
        </div>

        <div class="card-body" style="background-color:#F8F9FA;">
            <!-- FORMULARIO FECHA -->
            @using (Html.BeginForm("ResumenDiario", "Contabilidad", FormMethod.Get))
            {
                <div class="row g-4 align-items-end mt-2">
                    <div class="col-md-6">
                        <label class="form-label fw-semibold text-secondary">Seleccionar fecha:</label>
                        <div class="input-group shadow-sm">
                            <input type="text" id="fechaResumen" name="fecha"
                                   class="form-control" placeholder="Seleccione una fecha..."
                                   value="@DateTime.Now.ToString("yyyy-MM-dd")" autocomplete="off" />
                            <span class="input-group-text bg-info text-white">
                                <i class="bi bi-calendar3"></i>
                            </span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <button type="submit"
                                class="btn w-100 fw-semibold text-dark border-0 shadow-sm"
                                style="background-color:#FFD60A;">
                            <i class="bi bi-search me-1"></i> Generar Resumen
                        </button>
                    </div>
                </div>
            }

            <!-- MENSAJE ALERTA -->
            @if (ViewBag.Mensaje != null)
            {
                <div class="alert alert-warning alert-dismissible fade show mt-4 shadow-sm rounded-3" role="alert">
                    <i class="bi bi-exclamation-triangle-fill me-2"></i>
                    <strong>¡Aviso!</strong> @ViewBag.Mensaje
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            }

            <!-- TABLA DE RESUMEN -->
            @if (Model != null)
            {
                <div class="table-responsive mt-4">
                    <table class="table table-bordered table-hover align-middle text-center shadow-sm rounded-3 overflow-hidden">
                        <thead style="background-color:#E3F2FD; color:#1B263B;">
                            <tr>
                                <th class="fw-semibold">Concepto</th>
                                <th class="fw-semibold">Monto</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="text-start"><strong>Total Ingresos</strong></td>
                                <td class="text-success fw-bold">₡@Model.TotalIngresos.ToString("N2", cr)</td>
                            </tr>
                            <tr>
                                <td class="text-start"><strong>Total Egresos</strong></td>
                                <td class="text-danger fw-bold">₡@Model.TotalEgresos.ToString("N2", cr)</td>
                            </tr>
                            <tr style="background-color:#FFF9E6;">
                                <td class="text-start"><strong>Balance</strong></td>
                                <td class="fw-bold" style="color:@(Model.Balance >= 0 ? "#1B4332" : "#C1121F")">
                                    ₡@Model.Balance.ToString("N2", cr)
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            }

            <!-- VOLVER -->
            <div class="mt-4 text-end">
                <a href="@Url.Action("Index", "Contabilidad")"
                   class="btn fw-semibold text-dark border-0 shadow-sm px-4"
                   style="background-color:#FFD60A;">
                    <i class="bi bi-arrow-left-circle me-1"></i> Volver al Dashboard
                </a>
            </div>
        </div>
    </div>
</div>

<!-- ICONOS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.10.0/dist/css/bootstrap-datepicker3.min.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.10.0/dist/js/bootstrap-datepicker.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.10.0/dist/locales/bootstrap-datepicker.es.min.js"></script>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}

<!-- Script de calendario -->
<script>
$(function () {
    const $fecha = $('#fechaResumen');

    $fecha.datepicker({
        format: 'yyyy-mm-dd',
        language: 'es',
        autoclose: true,
        todayHighlight: true,
        orientation: 'bottom auto',
        clearBtn: true
    });
});
</script>

<!-- Estilos -->
<style>
    body {
        background-color: #fdfdfd;
    }

    .card {
        transition: 0.3s ease;
    }

        .card:hover {
            transform: translateY(-3px);
        }

    input.form-control {
        border: 2px solid #B6E0FE;
        background-color: #F9FCFF;
        border-radius: 10px;
    }

        input.form-control:focus {
            border-color: #0DCAF0;
            box-shadow: 0 0 5px rgba(13, 202, 240, 0.4);
        }

    .btn:hover {
        opacity: 0.9;
        transform: translateY(-2px);
    }

    .alert {
        font-size: 0.95rem;
    }

    table th, table td {
        vertical-align: middle;
    }
</style>
